extends index.jade

block title
	| Sessions


block main
	h1
		block title
		| 
		small ({{totalItems}} {{totalItems == 1 ? "Ergebniss" : "Ergebnisse"}})
	table(class="table table-hover table-striped")
		thead
			tr
				+tableHeader("Vorname", "firstName")
				+tableHeader("Nachname", "lastName")
				+tableHeader("Verein", "verein")
				+tableHeader("Linie", "line")
				+tableHeader("Disziplin", "disziplin")
				+tableHeader("Datum", "unixtime")
				th(style="width:10%;")
			tr
				td(colspan="6")
					input(autofocus onClick="this.select();" type="text" class="form-control container-fluid" ng-model="store.search" placeholder="Suche")
				td
					button(type="button" class="btn btn-primary btn noMargin col-xs-12" ng-click="newEntry()")
						span(class="glyphicon glyphicon-plus" aria-hidden="true")
						|  Neu
		tbody
			tr(ng-repeat="sessionGroup in sessionGroups track by $index")
				td {{sessionGroup.firstName}}
				td {{sessionGroup.lastName}}
				td {{sessionGroup.verein}}
				td {{sessionGroup.lineTitle}}
				td {{sessionGroup.disziplinTitle}} ({{sessionGroup.scheibeTitle}})
				td {{formateDate(sessionGroup.unixtime)}}
				td
					button(type="button" class="btn btn-link btn-sm noMargin col-xs-12" ng-click="editEntry(sessionGroup)")
						span(class="glyphicon glyphicon-pencil" aria-hidden="true")
						|  Bearbeiten
	+itemsPerPage()
	+pagination()
	
	//- modalEditingOverlay template
	script(type="text/ng-template" id="modalEditingOverlay.html")

		div(class="modal-header")
			button(type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()")
				span(aria-hidden="true") &times
			h4(class="modal-title" id="exampleModalLabel")
				span(class="glyphicon glyphicon-user" aria-hidden="true")
				|  {{line.label}} - {{group.firstName}} {{group.lastName}} ({{group.verein}})
		div(class="modal-body")
			form
				div(class="row")
					div(class="form-group col-md-4")
						label(class="control-label") Datum:
						p {{formateDate(group.unixtime)}}
					div(class="form-group col-md-4")
						label Linie:
						p {{group.lineTitle}}
					div(class="form-group col-md-4")
						label Disziplin:
						p {{group.disziplinTitle}} ({{group.scheibeTitle}})
						
					.divider
					
					div(class="form-group col-md-6")
						label(class="control-label") Verein:
						verein-typeahead(user="user" verein="verein")
					div(class="form-group col-md-6")
						label(class="control-label") Schütze:
						user-typeahead(user="user" verein="verein")
					
					div(ng-repeat="(sessionIndex, session) in sessions" class="form-group col-md-4" ng-hide="session.shots.length == 0")
						label(class="control-label") {{disziplin.parts[session.part].title}}
						table(class="table table-condensed table-striped")
							thead
								tr
									+tableHeader("Nr.", "number")
									+tableHeader("Ring", "ring")
									+tableHeader("Teiler", "ring")
							tbody
								tr(colspan="3" class="fullWidth")
									div(style="width:80%; margin-left:7%;")
										target(zoomlevel="disziplin.scheibe.defaultZoom" serie="session.shots" selectedshotindex="selectedshotindex[sessionIndex]" scheibe="disziplin.scheibe" probeecke="disziplin.parts[session.part].probeEcke")
								tr(ng-repeat="(shotIndex, shot) in session.shots" ng-click="selectedshotindex[sessionIndex] = shotIndex;" class="{{selectedshotindex[sessionIndex] == shotIndex ? 'success' : ''}}")
									td {{((shot.number-1) % disziplin.parts[session.part].serienLength) + 1}}.
									td {{shot.ring}}
									td {{shot.teiler}}
							tfooter
								tr(ng-click="selectedshotindex[sessionIndex] = -1;")
									td {{session.shots.length}}
									th {{session.sum}} Ringe
									th {{session.avg}} Schnitt
									
				
				
				
				.divider
				div(class="form-group")
					label(for="message-text" class="control-label") Notiz:
					textarea(class="form-control" id="message-text" ng-model="group.note")
		div(class="modal-footer")
			//- button(class="btn btn-danger pull-left" type="button" ng-click="delete()")
			//- 	span(class="glyphicon glyphicon-trash" aria-hidden="true")
			//- 	|  Löschen
			button(class="btn btn-primary" type="button" ng-click="save()")
				span(class="glyphicon glyphicon-floppy-disk" aria-hidden="true")
				|  Speichern
