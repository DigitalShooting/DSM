extends index.jade

block title
	| Aktive Wettkämpfe


block main
	h1 
		block title
		| 
		small ({{totalItems}} {{totalItems == 1 ? "Ergebniss" : "Ergebnisse"}})
	table(class="table table-hover table-striped")
		thead
			tr
				+tableHeader("Datum", "date")
				+tableHeader("Heim", "heim")
				+tableHeader("Gast", "gast")
				th(style="width:10%;")
			tr
				td(colspan="3")
					input(autofocus onClick="this.select();" type="text" class="form-control container-fluid" ng-model="store.search" placeholder="Suche")
				td(colspan="2")
					button(type="button" class="btn btn-primary btn noMargin col-xs-12" ng-click="newEntry()")
						span(class="glyphicon glyphicon-plus" aria-hidden="true")
						|  Neu
		tbody
			tr(ng-repeat="rwk in rwks track by $index")
				td {{rwk.date}}
				td {{rwk.heimVerein}} {{rwk.heim}} ({{rwk.heimSaison}})
				td {{rwk.gastVerein}} {{rwk.gast}} ({{rwk.gastSaison}})
				td
					button(type="button" class="btn btn-link btn-sm noMargin col-xs-12" ng-click="editEntry(rwk)")
						span(class="glyphicon glyphicon-pencil" aria-hidden="true")
						|  Bearbeiten
					button(type="button" class="btn btn-link btn-sm noMargin col-xs-12" ng-click="editUsers(rwk)")
						span(class="glyphicon glyphicon-user" aria-hidden="true")
						|  Aufstellung
				td
					button(type="button" class="btn btn-link btn-sm noMargin col-xs-12" ng-click="editScores(rwk)")
						span(class="glyphicon glyphicon-stats" aria-hidden="true")
						|  Ergebnisse
	+itemsPerPage()
	+pagination()
	
	
	
	
	//- modalEditingOverlay template
	script(type="text/ng-template" id="modalEditingOverlay.html")

		div(class="modal-header")
			button(type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()")
				span(aria-hidden="true") &times
			h4(class="modal-title" id="exampleModalLabel")
				span(class="glyphicon glyphicon-refresh" aria-hidden="true")
				|  {{heim.verein}} {{heim.name}} - {{gast.verein}} {{gast.name}}
		div(class="modal-body")
			form
				div(class="row")
					div(class="col-md-6")
						label(class="control-label") Datum:
						uib-datepicker(ng-model="date" show-weeks="false" class="well well-sm")
					div(class="form-group col-md-6")
						label(class="control-label") Heim Manschaft:
						manschaft-typeahead(user="user" verein="verein" manschaft="heim")
					div(class="form-group col-md-6")
						label(class="control-label") Gast Manschaft:
						manschaft-typeahead(user="user" verein="verein" manschaft="gast")
				.divider
				div(class="form-group")
					label(for="message-text" class="control-label") Notiz:
					textarea(class="form-control" id="message-text" ng-model="rwk.note")
		div(class="modal-footer")
			button(class="btn btn-default pull-left" type="button" ng-click="end()")
				span(class="glyphicon glyphicon-floppy-saved" aria-hidden="true")
				|  Wettkamp abschließen
			button(class="btn btn-primary" type="button" ng-click="save()")
				span(class="glyphicon glyphicon-floppy-disk" aria-hidden="true")
				|  Speichern






	
	//- modalUsersOverlay template
	script(type="text/ng-template" id="modalUsersOverlay.html")

		div(class="modal-header")
			button(type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()")
				span(aria-hidden="true") &times
			h4(class="modal-title" id="exampleModalLabel")
				span(class="glyphicon glyphicon-refresh" aria-hidden="true")
				|  {{rwk.heimVerein}} {{rwk.heim}} - {{rwk.gastVerein}} {{rwk.gast}}
		div(class="modal-body")
			form
				div(class="row")
					div(class="form-group col-md-6" ng-hide="members.length == 0")
						label(class="control-label") Aufstellung Heim:
						table(class="table table-hover table-striped")
							thead
								tr
									+tableHeader("Ersatz", "ersatz")
									+tableHeader("Vorname", "firstName")
									+tableHeader("Name", "lastName")
									th(style="width:10%;")
							tbody
								tr(ng-repeat="member in heimMembers")
									td
										input(type="checkbox" ng-model="member.ersatz" ng-true-value="1" ng-false-value="0" ng-change="member.post();")
									td {{member.firstName}}
									td {{member.lastName}}
									td
										button(type="button" class="btn btn-danger-link btn-sm noMargin col-xs-12" ng-click="delHeimUser(member)")
											span(class="glyphicon glyphicon-trash" aria-hidden="true")
											|  Löschen
					div(class="form-group col-md-6" ng-hide="members.length == 0")
						label(class="control-label") {{rwk.heimVerein}} {{rwk.heim}}:
						table(class="table table-hover table-striped")
							thead
								tr
									+tableHeader("Vorname", "firstName")
									+tableHeader("Name", "lastName")
									th(style="width:10%;")
							tbody
								tr(ng-repeat="member in heimManschaft")
									td {{member.firstName}}
									td {{member.lastName}}
									td
										button(type="button" class="btn btn-link btn-sm noMargin col-xs-12" ng-click="addHeimUser(member)")
											span(class="glyphicon glyphicon-plus" aria-hidden="true")
											|  Hinzufügen
				.divider
				div(class="row")
					div(class="form-group col-md-6" ng-hide="members.length == 0")
						label(class="control-label") Aufstellung Gast:
						table(class="table table-hover table-striped")
							thead
								tr
									+tableHeader("Ersatz", "ersatz")
									+tableHeader("Vorname", "firstName")
									+tableHeader("Name", "lastName")
									th(style="width:10%;")
							tbody
								tr(ng-repeat="member in gastMembers")
									td
										input(type="checkbox" ng-model="member.ersatz" ng-true-value="1" ng-false-value="0" ng-change="member.post();")
									td {{member.firstName}}
									td {{member.lastName}}
									td
										button(type="button" class="btn btn-danger-link btn-sm noMargin col-xs-12" ng-click="delGastUser(member)")
											span(class="glyphicon glyphicon-trash" aria-hidden="true")
											|  Löschen
					div(class="form-group col-md-6" ng-hide="members.length == 0")
						label(class="control-label") {{rwk.gastVerein}} {{rwk.gast}}:
						table(class="table table-hover table-striped")
							thead
								tr
									+tableHeader("Vorname", "firstName")
									+tableHeader("Name", "lastName")
									td(style="width:10%;")
							tbody
								tr(ng-repeat="member in gastManschaft")
									td {{member.firstName}}
									td {{member.lastName}}
									td
										button(type="button" class="btn btn-link btn-sm noMargin col-xs-12" ng-click="addGastUser(member)")
											span(class="glyphicon glyphicon-plus" aria-hidden="true")
											|  Hinzufügen
		div(class="modal-footer")
			button(class="btn btn-default" type="button" ng-click="cancel()")
				| Fertig


	//- modalScoresOverlay template
	script(type="text/ng-template" id="modalScoresOverlay.html")

		div(class="modal-header")
			button(type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()")
				span(aria-hidden="true") &times
			h4(class="modal-title" id="exampleModalLabel")
				span(class="glyphicon glyphicon-refresh" aria-hidden="true")
				|  {{heim.verein}} {{heim.name}} - {{gast.verein}} {{gast.name}}
		div(class="modal-body")
			form
				div(class="row")
					div(class="form-group col-md-6" ng-hide="members.length == 0")
						label(class="control-label") Heim:
						table(class="table table-hover table-striped")
							thead
								tr
									+tableHeader("Ersatz", "ersatz")
									+tableHeader("Vorname", "firstName")
									+tableHeader("Name", "lastName")
									+tableHeader("Ergebniss", "score")
							tbody
								tr(ng-repeat="member in heimMembers")
									td
										input(type="checkbox" disabled ng-model="member.ersatz" ng-true-value="1" ng-false-value="0" ng-change="member.post();")
									td {{member.firstName}}
									td {{member.lastName}}
									td
										table(ng-repeat="session in member.mainSessions")
											tbody
												td(ng-repeat="serie in session.serien") {{serie.gesamt}}
												th {{session.gesamt}}
								tr
									td
									td
									td
									th {{heimGesamt}}

					div(class="form-group col-md-6" ng-hide="members.length == 0")
						label(class="control-label") Gast:
						table(class="table table-hover table-striped")
							thead
								tr
									+tableHeader("Ersatz", "ersatz")
									+tableHeader("Vorname", "firstName")
									+tableHeader("Name", "lastName")
									+tableHeader("Ergebniss", "score")
							tbody
								tr(ng-repeat="member in gastMembers")
									td
										input(type="checkbox" disabled ng-model="member.ersatz" ng-true-value="1" ng-false-value="0" ng-change="member.post();")
									td {{member.firstName}}
									td {{member.lastName}}
									td
										table(ng-repeat="session in member.mainSessions")
											tbody
												td(ng-repeat="serie in session.serien") {{serie.gesamt}}
												th {{session.gesamt}}
								tr
									td
									td
									td
									th {{gastGesamt}}

		div(class="modal-footer")
			button(class="btn btn-default" type="button" ng-click="cancel()")
				| Fertig
