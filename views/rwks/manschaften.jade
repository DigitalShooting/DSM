extends index.jade

block title
	| Manschaften


block main
	h1 
		block title
		| 
		small ({{totalItems}} {{totalItems == 1 ? "Ergebniss" : "Ergebnisse"}})
	table(class="table table-hover table-striped")
		thead
			tr
				+tableHeader("Saison", "saison")
				+tableHeader("Verein", "verein")
				+tableHeader("Name", "name")
				th(style="width:10%;")
			tr
				td(colspan="3")
					input(autofocus onClick="this.select();" type="text" class="form-control container-fluid" ng-model="store.search" placeholder="Suche")
				td
					button(type="button" class="btn btn-primary btn noMargin col-xs-12" ng-click="newEntry()")
						span(class="glyphicon glyphicon-plus" aria-hidden="true")
						|  Neu
		tbody
			tr(ng-repeat="manschaft in manschaften track by $index")
				td {{manschaft.saison}}
				td {{manschaft.verein}}
				td {{manschaft.name}}
				td
					button(type="button" class="btn btn-link btn-sm noMargin col-xs-12" ng-click="editEntry(manschaft)")
						span(class="glyphicon glyphicon-pencil" aria-hidden="true")
						|  Bearbeiten
	div(class="dropup noMargin")
		div(class="btn-group pull-left" uib-dropdown is-open="status.isopen")
			button(id="single-button" type="button" class="btn btn-default noMargin" uib-dropdown-toggle ng-disabled="disabled")
				| Einträge pro Seite: {{store.itemsPerPage}} 
				span(class="caret")
			ul(class="uib-dropdown-menu" role="menu" aria-labelledby="single-button")
				li(role="menuitem")
					a(ng-click="store.itemsPerPage = 10;") 10
				li(role="menuitem")
					a(ng-click="store.itemsPerPage = 20") 20
				li(role="menuitem")
					a(ng-click="store.itemsPerPage = 50") 50
				li(role="menuitem")
					a(ng-click="store.itemsPerPage = 100") 100
	div(class="noMargin pull-right")
		uib-pagination(total-items="totalItems" items-per-page="store.itemsPerPage" ng-model="currentPage" max-size="paginationMaxSize" class="pagination noMargin" boundary-links="true" previous-text="Zurück" next-text="Weiter" first-text="Erste" last-text="Letzte")
	
	
	//- saisonTypeahead template
	script(type="text/ng-template" id="saisonTypeahead.html")
		a {{match.model.name}}
	
	
	//- vereinTypeahead template
	script(type="text/ng-template" id="vereinTypeahead.html")
		a {{match.model.name}}
		
		
	//- userTypeahead template
	script(type="text/ng-template" id="userTypeahead.html")
		a {{match.model.firstName}} {{match.model.lastName}}
	
	
	//- modalEditingOverlay template
	script(type="text/ng-template" id="modalEditingOverlay.html")

		div(class="modal-header")
			button(type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="cancel()")
				span(aria-hidden="true") &times
			h4(class="modal-title" id="exampleModalLabel")
				span(class="glyphicon glyphicon-th-large" aria-hidden="true")
				|  {{verein.name}} {{manschaft.name}}
		div(class="modal-body")
			form
				div(class="row")
					div(class="form-group col-md-6")
						label(class="control-label") Manschafts Name/ Nummer:
						input(type="text" class="form-control" ng-model="manschaft.name")
					div(class="form-group col-md-6")
						label(class="control-label") Runde:
						input(onClick="this.select();" type="text" ng-model="saison" placeholder="" uib-typeahead="saison as saison.name for saison in getSaison($viewValue)" typeahead-loading="loadingSaisons" typeahead-template-url="saisonTypeahead.html" typeahead-no-results="noResultsSaisons" class="form-control")
						i(ng-show="loadingSaisons" class="glyphicon glyphicon-refresh")
						div(ng-show="noResultsSaisons")
							i(class="glyphicon glyphicon-remove")
							| Keine Runde gefunden
					div(class="form-group col-md-6")
						label(class="control-label") Verein:
						input(onClick="this.select();" type="text" ng-model="verein" placeholder="" uib-typeahead="verein as verein.name for verein in getVereine($viewValue)" typeahead-loading="loadingVereine" typeahead-template-url="vereinTypeahead.html" typeahead-no-results="noResultsVerein" class="form-control")
						i(ng-show="loadingVereine" class="glyphicon glyphicon-refresh")
						div(ng-show="noResultsVerein")
							i(class="glyphicon glyphicon-remove")
							| Kein Verein gefunden
				.divider
				div(class="row")
					div(class="form-group col-md-6" ng-hide="members.length == 0")
						label(class="control-label") Schützen:
						table(class="table table-hover table-striped")
							thead
								tr
									+tableHeader("Stamm", "stamm")
									+tableHeader("Vorname", "firstName")
									+tableHeader("Name", "lastName")
									th(style="width:10%;")
							tbody
								tr(ng-repeat="member in members track by $index")
									td
										input(type="checkbox" ng-model="member.stamm" ng-true-value="1" ng-false-value="0" ng-change="member.post();")
									td {{member.firstName}}
									td {{member.lastName}}
									td
										button(type="button" class="btn btn-danger-link btn-sm noMargin col-md-12" ng-click="deleteMember(member)")
											span(class="glyphicon glyphicon-trash" aria-hidden="true")
											|  Löschen
					div(class="form-group col-md-6")
						label(class="control-label") Schütze hinzufügen:
						div(class="input-group col-md-12")
							input(type="text" ng-model="newUser" placeholder="Schütze hinzufügen" uib-typeahead="user for user in getUsers($viewValue)" typeahead-loading="loadingUser" typeahead-input-formatter="getUserTitle($model)" typeahead-template-url="userTypeahead.html" typeahead-no-results="noResultsUser" class="form-control")
							i(ng-show="loadingUser" class="glyphicon glyphicon-refresh")
							div(ng-show="noResultsUser")
								i(class="glyphicon glyphicon-remove")
								| Kein Schütze gefunden
							span(class="input-group-btn")
								button(type="button" class="btn btn-default btn noMargin" ng-click="addMember()")
									span(class="glyphicon glyphicon-plus" aria-hidden="true")
									|  Hinzufügen

				.divider
				div(class="form-group")
					label(for="message-text" class="control-label") Notiz:
					textarea(class="form-control" id="message-text" ng-model="manschaft.note")
		div(class="modal-footer")
			button(class="btn btn-danger pull-left" type="button" ng-click="delete()" ng-confirm-click="Would you like to say hi?")
				span(class="glyphicon glyphicon-trash" aria-hidden="true")
				|  Löschen
			button(class="btn btn-primary" type="button" ng-click="save()")
				span(class="glyphicon glyphicon-floppy-disk" aria-hidden="true")
				|  Speichern
